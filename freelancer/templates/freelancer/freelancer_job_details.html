<div class="container mt-5">
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h2>{{ job.title }}</h2>
        </div>
        <div class="card-body">
            <h5 class="card-title"><strong>Category:</strong> {{ job.category }}</h5>
            <p class="card-text"><strong>Description:</strong> {{ job.description }}</p>
            <p class="card-text"><strong>Budget:</strong> ${{ job.budget }}</p>
            <p class="card-text"><strong>Status:</strong> 
                <span class="badge {% if job.status == 'Open' %}bg-success{% else %}bg-danger{% endif %}">
                    {{ job.status }}
                </span>
            </p>
            <p class="card-text"><strong>Deadline:</strong> {{ job.deadline|date:"M d, Y H:i" }}</p> <!-- Display the deadline -->
            
            <!-- Countdown Timer -->
            <p id="countdown"></p>  <!-- This is where the countdown will be displayed -->
        </div>
        <div class="card-footer d-flex justify-content-between">
            <a href="{% url 'freelancer_available_jobs' %}" class="btn btn-secondary">
                Back to Available Jobs
            </a>
            {% if job.status == 'Open' %}
            <a href="#" class="btn btn-success">
                Apply for Job
            </a>
            {% endif %}
        </div>
    </div>
</div>

<script>
    // Countdown Timer Script
    const deadline = new Date("{{ job.deadline|date:'Y/m/d H:i' }}").getTime();
    const countdownElement = document.getElementById("countdown");

    const interval = setInterval(function() {
        const now = new Date().getTime();
        const distance = deadline - now;

        if (distance < 0) {
            clearInterval(interval);
            countdownElement.innerHTML = "The deadline has passed!";
        } else {
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            countdownElement.innerHTML = `Time remaining: ${days}d ${hours}h ${minutes}m ${seconds}s`;
        }
    }, 1000);
</script>
